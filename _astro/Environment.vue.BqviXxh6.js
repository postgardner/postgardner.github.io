import{d as T,M as E,c as le,K as L,b as D,o as d,k as j,x as R,H as O,B as w,e as _,u as r,D as B,q as C,z as P,X as oe,aF as Ce,f,av as ke,w as h,T as q,J as te,E as G,aE as ye,$ as J,t as H,aG as ae,ax as ge,aH as Ee,F as we,U as _e,L as K,ay as g,a2 as $e,aI as Ie,Z as ze,Y as Se,p as Ve,aw as je}from"./_OpenAPI.CJmNRckt.js";import{d as De}from"./LibraryIcon.vue.B2-VRuO7.js";import{C as Me}from"./EditSidebarListElement.vue.DNvOjsvB.js";import{m as Ne,g as Be}from"./SidebarButton.vue.DVEFglS6.js";import{h as We,b as Ue,_ as Fe,a as ee}from"./CommandActionInput.vue.Bod6t08A.js";import{u as Oe}from"./ViewLayout.vue.C9dWeGk8.js";import{x as Re}from"./ViewLayoutContent.vue.UrlDXuaH.js";import{_ as Te}from"./ViewLayoutSection.vue.zBItOo3b.js";import{a as Ae}from"./DeleteSidebarListElement.vue.Cw9ULXXU.js";import"./jsx-runtime.DCqPeNwG.js";import"./index.66AI1_x2.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./preload-helper.BlTxHScW.js";import"./floating-ui.dom.DfmbYluP.js";/* empty css                       */import"./ScalarHotkey.vue.YynLEUCJ.js";const Ke=["onClick"],Pe=["placeholder"],ne=T({__name:"EnvironmentColors",props:{activeColor:{},selector:{type:Boolean,default:!1}},emits:["select"],setup(W,{emit:$}){const n=W,y=$,p=E(""),i=E(null),k=E(!1),b=E(!1),v=[{color:"#8E8E8E"},{color:"#EF0006"},{color:"#EDBE20"},{color:"#069061"},{color:"#FB892C"},{color:"#0082D0"},{color:"#5203D1"},{color:"#FFC0CB"}],I=le(()=>n.activeColor&&!v.some(t=>t.color===n.activeColor)||p.value?`background-color: ${n.activeColor||p.value};`:"background: linear-gradient(to right, rgb(235, 87, 87), rgb(242, 201, 76), rgb(76, 183, 130), rgb(78, 167, 252), rgb(250, 96, 122));"),z=()=>{k.value=!k.value,n.selector&&(b.value=!1),ke(()=>{i.value&&i.value.focus()})};L(p,t=>{t&&!t.startsWith("#")&&(p.value=`#${t}`),k.value=!0});const M=()=>{n.selector&&(b.value=!b.value)},S=t=>{y("select",t),n.selector&&(b.value=!1)};return(t,a)=>(d(),D("div",null,[k.value?j("",!0):(d(),D(R,{key:0},[n.selector&&!b.value?(d(),D("div",{key:0,class:w(["flex cursor-pointer items-center justify-center rounded-full",n.selector?"h-4 w-4":"h-5 w-5"]),style:O({backgroundColor:t.activeColor}),onClick:M},[t.activeColor?(d(),_(r(B),{key:0,class:w(["text-c-btn",n.selector&&"p-0.5"]),icon:"Checkmark",size:"xs"},null,8,["class"])):j("",!0)],6)):j("",!0),b.value||!n.selector?(d(),D("div",{key:1,class:w(["color-selector flex flex-row items-center justify-between gap-1.5 space-x-1",n.selector?"h-4":"min-h-10 min-w-[296px]"])},[(d(),D(R,null,P(v,m=>C("div",{key:m.color,class:w(["flex cursor-pointer items-center justify-center rounded-full",n.selector?"h-4 w-4":"h-5 w-5"]),style:O({backgroundColor:m.color}),onClick:c=>S(m.color)},[t.activeColor===m.color&&!p.value?(d(),_(r(B),{key:0,class:w(["text-c-btn",n.selector&&"p-0.5"]),icon:"Checkmark",size:"xs"},null,8,["class"])):j("",!0)],14,Ke)),64)),a[2]||(a[2]=C("hr",{class:"border-ghost h-5 w-0.5 border-l"},null,-1)),C("label",{class:w(["z-10 flex cursor-pointer flex-row items-center justify-center gap-2 rounded-full",n.selector?"h-4 w-4":"h-5 w-5"]),style:O(I.value),onClick:z},[!k.value&&(t.activeColor===p.value||t.activeColor&&!v.some(m=>m.color===t.activeColor))?(d(),_(r(B),{key:0,class:"text-c-btn",icon:"Checkmark",size:"xs"})):j("",!0)],6)],2)):j("",!0)],64)),k.value?(d(),D("div",{key:1,class:w(["color-selector flex flex-1 items-center gap-2 rounded",n.selector?"h-4":"min-h-10"])},[C("span",{class:w(["absolute rounded-full border border-dashed",n.selector?"h-4 w-4":"h-5 w-5"])},null,2),C("span",{class:w(["z-[1] rounded-full",n.selector?"h-4 w-4":"h-5 w-5"]),style:O(I.value)},null,6),oe(C("input",{ref_key:"customColorInputRef",ref:i,"onUpdate:modelValue":a[0]||(a[0]=m=>p.value=m),class:"w-full flex-1 border-transparent text-sm outline-none",placeholder:t.activeColor||"#000000",type:"text",onInput:a[1]||(a[1]=m=>S(p.value))},null,40,Pe),[[Ce,p.value]]),C("button",{class:"text-c-3 hover:bg-b-2 rounded-lg p-1.5",type:"button",onClick:z},[f(r(B),{icon:"Checkmark",size:"xs"})])],2)):j("",!0)]))}}),Ge={class:"flex flex-col gap-4"},Je=T({__name:"EnvironmentColorModal",props:{state:{},selectedColor:{}},emits:["cancel","submit"],setup(W,{emit:$}){const n=W,y=$,p=E(""),i=b=>{p.value=b},k=()=>{y("submit",p.value),p.value=""};return(b,v)=>(d(),_(r(q),{size:"xxs",state:b.state,title:"Edit Environment Color"},{default:h(()=>[C("div",Ge,[f(ne,{activeColor:p.value||n.selectedColor,class:"w-full p-1",onSelect:i},null,8,["activeColor"]),f(Ae,{onCancel:v[0]||(v[0]=I=>y("cancel")),onSubmit:k})])]),_:1},8,["state"]))}}),He={class:"flex items-start gap-2"},Le=T({__name:"EnvironmentModal",props:{state:{},activeWorkspaceCollections:{},collectionId:{}},emits:["cancel","submit"],setup(W,{emit:$}){const n=W,y=$,{events:p}=te(),i=E(""),k=E("#8E8E8E"),b=le(()=>[...n.activeWorkspaceCollections.filter(t=>{var a;return((a=t.info)==null?void 0:a.title)!=="Drafts"}).map(t=>{var a;return{id:t.uid,label:((a=t.info)==null?void 0:a.title)??"Untitled Collection"}})]),v=E(b.value.find(t=>t.id===n.collectionId)),{toast:I}=ae(),z=t=>{k.value=t};L(()=>n.state.open,t=>{t&&(i.value="",k.value="#8E8E8E",n.collectionId?v.value=b.value.find(a=>a.id===n.collectionId):v.value=void 0)});const M=()=>{var t,a,m,c;if(!((t=v.value)!=null&&t.id)){I("Please select a collection before adding an environment.","error");return}y("submit",{name:i.value,color:k.value,type:((a=v.value)==null?void 0:a.id)==="global"?"global":"collection",collectionId:((m=v.value)==null?void 0:m.id)!=="global"?(c=v.value)==null?void 0:c.id:void 0})},S=()=>{n.state.hide(),p.commandPalette.emit({commandName:"Create Collection"})};return(t,a)=>(d(),_(r(q),{bodyClass:"border-t-0 rounded-t-lg",size:"xs",state:t.state},{default:h(()=>[f(We,{disabled:!v.value,onCancel:a[2]||(a[2]=m=>y("cancel")),onSubmit:M},{options:h(()=>[f(r(ye),{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=m=>v.value=m),options:b.value,placeholder:"Select Type"},{default:h(()=>[b.value.length>0?(d(),_(r(J),{key:0,class:"hover:bg-b-2 max-h-8 w-fit justify-between gap-1 p-2 text-xs",variant:"outlined"},{default:h(()=>[C("span",{class:w(v.value?"text-c-1":"text-c-3")},H(v.value?v.value.label:"Select Collection"),3),f(r(B),{class:"text-c-3",icon:"ChevronDown",size:"xs"})]),_:1})):(d(),_(r(J),{key:1,class:"hover:bg-b-2 max-h-8 justify-between gap-1 p-2 text-xs",variant:"outlined",onClick:S},{default:h(()=>a[3]||(a[3]=[C("span",{class:"text-c-1"},"Create Collection",-1)])),_:1}))]),_:1},8,["modelValue","options"])]),submit:h(()=>a[4]||(a[4]=[G(" Add Environment ")])),default:h(()=>[C("div",He,[f(ne,{activeColor:k.value,class:"peer",selector:"",onSelect:z},null,8,["activeColor"]),f(Ue,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=m=>i.value=m),class:"-mt-[.5px] !p-0 peer-has-[.color-selector]:hidden",placeholder:"Environment name"},null,8,["modelValue"])])]),_:1},8,["disabled"])]),_:1},8,["state"]))}}),qe={class:"flex-1"},Xe=["onClick"],Ye={class:"flex h-5 max-w-[14px] items-center justify-center"},fl=T({__name:"Environment",setup(W){const $=ge(),n=Ee(),{activeWorkspace:y,activeEnvironment:p,activeWorkspaceCollections:i,activeEnvVariables:k}=we(),{events:b,workspaceMutators:v,collectionMutators:I}=te(),{collapsedSidebarFolders:z,toggleSidebarFolder:M}=_e(),S=K(),t=K(),a=K(),m=E(null),c=E("default"),X=E(""),U=E(void 0),V=E(void 0),F=E(void 0),{toast:Y}=ae(),se=l=>JSON.parse(l);function Z(l,o,e){var s;l&&(o.uid===e?Y(`Environment name already used in ${(s=o.info)==null?void 0:s.title}`,"error"):Y("Environment name already used in another collection","error"))}function re(l){i.value.some(o=>{const e=Object.keys(o["x-scalar-environments"]||{}).includes(l.name);return Z(e,o,l.collectionId),e})||(l.collectionId&&(I.addEnvironment(l.name,{variables:{},color:l.color},l.collectionId),z[l.collectionId]||M(l.collectionId),$.push({name:"environment.collection",params:{[g.Collection]:l.collectionId,[g.Environment]:l.name}})),t.hide())}function ie(l){var o,e;if(p){const s=se(l);if(c.value==="default")v.edit((o=y.value)==null?void 0:o.uid,"environments",s);else{const x=i.value.find(u=>{var N;return(N=u["x-scalar-environments"])==null?void 0:N[c.value??""]});if((e=x?.["x-scalar-environments"])!=null&&e[c.value??""]){const u=x["x-scalar-environments"][c.value??""];u&&(u.variables=s,I.edit(x.uid,"x-scalar-environments",x["x-scalar-environments"]))}}}}const A=l=>{U.value=l,t.show()},ce=(l,o)=>{V.value=l,U.value=o,F.value=l,a.show()},ue=l=>{var o,e,s;m.value=l,X.value=((s=(e=(o=i.value.find(x=>{var u;return(u=x["x-scalar-environments"])==null?void 0:u[l]}))==null?void 0:o["x-scalar-environments"])==null?void 0:e[l])==null?void 0:s.color)??"",S.show()},ve=l=>{const o=m.value;typeof o=="string"&&(i.value.some(e=>{var s;return(s=e["x-scalar-environments"])==null?void 0:s[o]})&&i.value.forEach(e=>{var s;(s=e["x-scalar-environments"])!=null&&s[o]&&(e["x-scalar-environments"][o].color=l,I.edit(e.uid,"x-scalar-environments",e["x-scalar-environments"]))}),S.hide())};function de(l){i.value.forEach(e=>{I.removeEnvironment(l,e.uid)});const o=i.value.flatMap(e=>Object.keys(e["x-scalar-environments"]||{}));if(o.length>0){const e=o[o.length-1];if(!e)return;const s=i.value.find(x=>Object.keys(x["x-scalar-environments"]||{}).includes(e));c.value=e,$.push({name:"environment.collection",params:{collectionId:s?.uid,environmentId:e}}),s&&!z[s.uid]&&M(s.uid)}else c.value="default",$.push({name:"environment",params:{environment:"default"}})}const me=()=>c.value==="default"?"Global Environment":c.value,fe=()=>{var l,o,e,s;return c.value==="default"?JSON.stringify((l=y.value)==null?void 0:l.environments,null,2):JSON.stringify((s=(e=(o=i.value.find(x=>{var u;return(u=x["x-scalar-environments"])==null?void 0:u[c.value??""]}))==null?void 0:o["x-scalar-environments"])==null?void 0:e[c.value??""])==null?void 0:s.variables,null,2)},pe=l=>z[l],Q=l=>{l!=null&&l.createNew&&n.name==="environment"&&A()};L(()=>[n.params[g.Collection],n.params[g.Environment]],([l,o])=>{l?c.value=o:c.value="default"}),$e(()=>{c.value=n.params[g.Environment]||"default",b.hotKeys.on(Q);const l=n.params[g.Collection];l&&!z[l]&&M(l)}),Ie(()=>b.hotKeys.off(Q));const be=(l,o,e)=>{var s,x;const u=e?{name:"environment.collection",params:{[g.Workspace]:(s=y.value)==null?void 0:s.uid,[g.Collection]:e,[g.Environment]:o}}:{name:"environment.default",params:{[g.Workspace]:(x=y.value)==null?void 0:x.uid,[g.Environment]:o}};l.metaKey?window.open($.resolve(u).href,"_blank"):$.push(u)};function xe(){V.value=void 0,U.value=void 0,F.value=void 0,a.hide()}function he(l){i.value.some(o=>{const e=Object.keys(o["x-scalar-environments"]||{}).includes(l);return Z(e,o,U.value),e})||(l&&V.value!=="default"&&i.value.forEach(o=>{var e;if((e=o["x-scalar-environments"])!=null&&e[V.value??""]){const s=o["x-scalar-environments"][V.value??""];s&&(delete o["x-scalar-environments"][V.value??""],o["x-scalar-environments"][l]=s,I.edit(o.uid,"x-scalar-environments",o["x-scalar-environments"]))}}),l&&c.value===V.value&&(c.value=l),V.value=void 0,U.value=void 0,F.value=void 0,a.hide())}return(l,o)=>(d(),_(Oe,null,{default:h(()=>[f(Ne,{title:"Collections"},{content:h(()=>[C("div",qe,[f(Fe,null,{default:h(()=>[(d(),_(ee,{key:"default",class:"text-xs",isCopyable:!1,to:{name:"environment.default",params:{[r(g).Environment]:"default"}},type:"environment",variable:{name:"Global Environment",uid:"default",icon:"Globe",isDefault:!0}},null,8,["to"])),(d(!0),D(R,null,P(r(i),e=>{var s;return d(),D("li",{key:e.uid,class:"gap-1/2 flex flex-col"},[C("button",{class:"hover:bg-b-2 group flex w-full items-center gap-1.5 break-words rounded p-1.5 text-left text-sm font-medium",type:"button",onClick:x=>r(M)(e.uid)},[C("span",Ye,[f(r(De),{class:"text-sidebar-c-2 size-3.5 min-w-3.5 stroke-2 group-hover:hidden",src:e["x-scalar-icon"]||"interface-content-folder"},null,8,["src"]),C("div",{class:w({"rotate-90":r(z)[e.uid]})},[f(r(B),{class:"text-c-3 hover:text-c-1 hidden text-sm group-hover:block",icon:"ChevronRight",size:"md"})],2)]),G(" "+H(((s=e.info)==null?void 0:s.title)??""),1)],8,Xe),oe(C("div",{class:w({"before:bg-border before:z-1 relative mb-[.5px] before:pointer-events-none before:absolute before:left-3 before:top-0 before:h-[calc(100%_+_.5px)] before:w-[.5px] last:mb-0 last:before:h-full":Object.keys(e["x-scalar-environments"]||{}).length>0})},[(d(!0),D(R,null,P(e["x-scalar-environments"],(x,u)=>(d(),_(ee,{key:u,class:"text-xs [&>a]:pl-5",collectionId:e.uid,isCopyable:!1,isDeletable:!0,isRenameable:!0,to:{name:"collection.environment",params:{[r(g).Collection]:e.uid,[r(g).Environment]:u}},type:"environment",variable:{name:u,uid:u,color:x.color??"#8E8E8E",isDefault:!1},warningMessage:"Are you sure you want to delete this environment?",onClick:ze(N=>be(N,u,e.uid),["prevent"]),onColorModal:N=>ue(u),onDelete:N=>de(u),onRename:N=>ce(u,e.uid)},null,8,["collectionId","to","variable","onClick","onColorModal","onDelete","onRename"]))),128)),Object.keys(e["x-scalar-environments"]||{}).length===0?(d(),_(r(J),{key:0,class:"text-c-1 hover:bg-b-2 flex h-8 w-full justify-start gap-1.5 py-0 pl-6 text-xs",variant:"ghost",onClick:x=>A(e.uid)},{default:h(()=>[f(r(B),{icon:"Add",size:"sm"}),o[2]||(o[2]=C("span",null,"Add Environment",-1))]),_:2},1032,["onClick"])):j("",!0)],2),[[Se,pe(e.uid)]])])}),128))]),_:1})])]),button:h(()=>[f(Be,{click:A,hotkey:"N"},{title:h(()=>o[3]||(o[3]=[G(" Add Environment ")])),_:1})]),_:1}),f(Re,{class:"flex-1"},{default:h(()=>[f(Te,null,Ve({default:h(()=>[c.value&&r(y)?(d(),_(je,{key:0,class:"py-2 pl-px pr-2 md:px-4",envVariables:r(k),environment:r(p),isCopyable:"",language:"json",lineNumbers:"",lint:"",modelValue:fe(),workspace:r(y),"onUpdate:modelValue":ie},null,8,["envVariables","environment","modelValue","workspace"])):j("",!0)]),_:2},[c.value?{name:"title",fn:h(()=>[C("span",null,H(me()),1)]),key:"0"}:void 0]),1024)]),_:1}),f(Je,{selectedColor:X.value,state:r(S),onCancel:o[0]||(o[0]=e=>r(S).hide()),onSubmit:ve},null,8,["selectedColor","state"]),f(Le,{activeWorkspaceCollections:r(i),collectionId:U.value,state:r(t),onCancel:o[1]||(o[1]=e=>r(t).hide()),onSubmit:re},null,8,["activeWorkspaceCollections","collectionId","state"]),f(r(q),{size:"xxs",state:r(a),title:`Edit ${V.value}`},{default:h(()=>[f(Me,{name:F.value??"",onClose:xe,onEdit:he},null,8,["name"])]),_:1},8,["state","title"])]),_:1}))}});export{fl as default};
