import{j as e}from"./jsx-runtime.DCqPeNwG.js";import{r as m}from"./index.66AI1_x2.js";import{a as v,b as M}from"./url-builder.CA2d8hgU.js";import{g as R,S as k,T as E,P as S}from"./components.ChMrURz-.js";import{a as b,F as P}from"./ServerIcon.DkuCCljB.js";import{a as $}from"./EnvelopeIcon.D1la4CBn.js";import"./_commonjsHelpers.Cpj98o6Y.js";const F=m.memo(({message:s,collection:l})=>{const{Icon:d,color:o}=R(s.collection);return e.jsxs("a",{href:v(`/docs/${s.collection}/${s.data.id}/${s.data.version}`),className:"group flex border border-gray-200 items-center gap-1 rounded-md text-[11px] font-medium hover:bg-gray-50 transition-colors duration-200 bg-white",children:[e.jsx("div",{className:"bg-white border-r border-gray-200 px-2 py-1.5 rounded-l-md",children:e.jsx(d,{className:`h-3 w-3 text-${o}-500`})}),e.jsx("span",{className:"px-1 py-1 truncate max-w-[140px]",children:s.data.name})]})}),C=m.memo(({messages:s,type:l,selectedTypes:d})=>{const o=l==="receives"?"blue":"green",u=s?.filter(i=>d.length===0||d.includes(i.collection));return e.jsx("div",{className:`flex-1 h-full flex flex-col bg-${o}-100 border border-${o}-300 rounded-lg p-4`,children:e.jsxs("div",{className:"space-y-2 flex-1",children:[u?.map(i=>e.jsx(F,{message:i,collection:i.collection},i.data.name)),(!s?.length||d.length>0&&!s?.some(i=>d.includes(i.collection)))&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 text-[10px]",children:d.length>0?`Service does not ${l} ${d.join(" or ")}`:`Service does not ${l} any messages`})})]})})}),w=m.memo(({service:s,urlParams:l,selectedTypes:d})=>e.jsx("a",{href:M("/architecture/messages",{serviceName:s.data.name,serviceId:s.data.id,domainId:l?.domainId,domainName:l?.domainName}),className:"group hover:bg-pink-50 bg-white border-2 border-dashed border-pink-400 rounded-lg shadow-sm hover:shadow-lg transition-all duration-200 overflow-hidden ",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(b,{className:"h-5 w-5 text-pink-500"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 truncate group-hover:underline transition-colors duration-200 w-full max-w-[90%]",children:[s.data.name||s.data.id," (v",s.data.version,")"]})]})}),s.data.summary&&e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2 min-h-[2.5rem]",children:s.data.summary}),!l?.serviceName&&e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx(C,{messages:s.data.receives,type:"receives",selectedTypes:d}),e.jsxs("div",{className:"flex items-center gap-2 max-w-[200px]",children:[e.jsx("div",{className:"w-4 h-[2px] bg-blue-200"}),e.jsx("div",{className:"bg-white border-2 border-pink-100 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(b,{className:"h-8 w-8 text-pink-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.data.name||s.data.id}),e.jsxs("p",{className:"text-xs text-gray-500",children:["v",s.data.version]})]})]})}),e.jsx("div",{className:"w-4 h-[2px] bg-emerald-200"})]}),e.jsx(C,{messages:s.data.sends,type:"sends",selectedTypes:d})]})]})})),L=m.memo(({domain:s,services:l,urlParams:d,selectedTypes:o})=>{const u=s.data.domains||[],i=u.map(r=>r.data.services||[]).flat(),f=l.filter(r=>!i.some(x=>x.id===r.data.id));return e.jsxs("div",{className:"space-y-6",children:[f.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 xl:grid-cols-2 gap-6",children:f.map(r=>e.jsx(w,{service:r,urlParams:d,selectedTypes:o},r.data.id))}),u.map(r=>{const x=s.data.domains?.find(a=>a.data.id===r.data.id);if(!x)return null;const h=l.filter(a=>x.data.services?.some(p=>p.id===a.data.id));return h.length===0?null:e.jsxs("div",{className:"bg-orange-50 border-2 border-orange-400 rounded-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-orange-500"}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[x.data.name," (Subdomain)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:v(`/visualiser/domains/${x.data.id}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium bg-white border border-gray-300 rounded-md transition-colors duration-200",children:"View in visualizer"}),e.jsx("a",{href:v(`/docs/domains/${x.data.id}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-black border border-gray-300 bg-white rounded-md transition-colors duration-200",children:"Read documentation"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 xl:grid-cols-2 gap-6",children:h.map(a=>e.jsx(w,{service:a,urlParams:{...d,domainId:x.data.id,domainName:`${x.data.name} (Subdomain)`},selectedTypes:o},a.data.id))})]},x.data.id)})]})});function _({services:s,domains:l,embeded:d}){const[o,u]=m.useState(""),[i,f]=m.useState(1),[r,x]=m.useState([]),h=16,[a,p]=m.useState(null);m.useEffect(()=>{const t=new URLSearchParams(window.location.search);p({serviceIds:t.get("serviceIds")?.split(",").filter(Boolean),domainId:t.get("domainId")||void 0,domainName:t.get("domainName")||void 0,serviceName:t.get("serviceName")||void 0})},[]);const n=m.useMemo(()=>{if(a===null)return[];let t=[...s];if(a.serviceIds?.length&&(t=t.filter(c=>a.serviceIds?.includes(c.data.id)&&!c.data.id.includes("/versioned/"))),o){const c=o.toLowerCase();t=t.filter(g=>g.data.name?.toLowerCase().includes(c)||g.data.summary?.toLowerCase().includes(c)||g.data.sends?.some(j=>j.data.name.toLowerCase().includes(c))||g.data.receives?.some(j=>j.data.name.toLowerCase().includes(c)))}return r.length>0&&(t=t.filter(c=>{const g=c.data.sends?.some(N=>r.includes(N.collection)),j=c.data.receives?.some(N=>r.includes(N.collection));return g||j})),t.sort((c,g)=>(c.data.name||c.data.id).localeCompare(g.data.name||g.data.id)),t},[s,o,a,r]),y=m.useMemo(()=>{if(a?.domainId||a?.serviceIds?.length)return n;const t=(i-1)*h;return n.slice(t,t+h)},[n,i,a]),I=m.useMemo(()=>a?.domainId||a?.serviceIds?.length?1:Math.ceil(n.length/h),[n.length,a]);return m.useEffect(()=>{f(1)},[o,r]),e.jsxs("div",{children:[e.jsxs("nav",{className:"mb-4 flex items-center space-x-2 text-sm text-gray-500",children:[e.jsxs("a",{href:v("/architecture/domains"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Domains"]}),e.jsx($,{className:"h-4 w-4"}),e.jsxs("a",{href:v("/architecture/services"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"Services"]}),a?.domainId&&e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{className:"text-gray-900",children:a.domainId})]})]}),e.jsx("div",{className:"relative border-b border-gray-200 mb-4 pb-4",children:e.jsxs("div",{className:"md:flex md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1 max-w-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:a?.domainId?`${a.domainName} Architecture`:"All Services"})}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:a?.domainId?`Browse services and messages in the ${a.domainId} domain`:"Browse and discover services in your event-driven architecture"})]}),e.jsx("div",{className:"mt-6 md:mt-0 md:ml-4 flex-shrink-0",children:e.jsx(k,{searchQuery:o,onSearchChange:u,placeholder:"Search services by name, summary, or messages...",totalResults:n.length,totalItems:s.length})})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(E,{selectedTypes:r,onTypeChange:x,filteredCount:n.length,totalCount:s.length}),e.jsx("div",{className:"text-sm text-gray-500",children:a?.domainId||a?.serviceIds?.length?e.jsxs("span",{children:["Showing ",n.length," services in the ",a.domainId," domain"]}):e.jsxs("span",{children:["Showing ",(i-1)*h+1," to"," ",Math.min(i*h,n.length)," of ",n.length," ","services"]})}),!(a?.domainId||a?.serviceIds?.length)&&e.jsx(S,{currentPage:i,totalPages:I,totalItems:n.length,itemsPerPage:h,onPageChange:f})]})}),n.length>0&&e.jsx("div",{className:`rounded-xl overflow-hidden ${a?.domainId?"bg-yellow-50 p-8 border-2 border-yellow-400":""}`,children:a?.domainName?l.filter(t=>t.data.id===a.domainId).map(t=>e.jsx(L,{domain:t,services:y,urlParams:a,selectedTypes:r},t.data.id)):e.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 xl:grid-cols-${d?1:2} gap-6`,children:y.map(t=>e.jsx(w,{service:t,urlParams:a,selectedTypes:r},t.data.id))})}),n.length===0&&e.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-500 text-lg",children:r.length>0?`No services found that ${r.length>1?"handle":"handles"} ${r.join(" or ")} messages`:"No services found matching your criteria"})}),!(a?.domainId||a?.serviceIds?.length)&&e.jsx("div",{className:"mt-8 border-t border-gray-200",children:e.jsx(S,{currentPage:i,totalPages:I,totalItems:n.length,itemsPerPage:h,onPageChange:f})})]})}export{_ as default};
