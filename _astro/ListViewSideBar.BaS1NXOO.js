import{j as e}from"./jsx-runtime.DCqPeNwG.js";import{R as j,r as i}from"./index.66AI1_x2.js";import{b as C,a as m}from"./url-builder.CA2d8hgU.js";import{F as $}from"./ChevronDownIcon.DacXGLUg.js";import"./_commonjsHelpers.Cpj98o6Y.js";const b=({isCollapsed:r,onToggle:a,title:t,children:n,className:d=""})=>e.jsxs("div",{className:d,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:f=>{f.stopPropagation(),a()},className:"p-1 hover:bg-gray-100 rounded-md",children:e.jsx("div",{className:`transition-transform duration-150 ${r?"":"rotate-180"}`,children:e.jsx($,{className:"h-3 w-3 text-gray-500"})})}),typeof t=="string"?e.jsx("button",{onClick:f=>{f.stopPropagation(),a()},className:"flex-grow flex items-center justify-between px-2 py-0.5 text-xs font-bold rounded-md",children:t}):t]}),e.jsx("div",{className:`overflow-hidden transition-[height] duration-150 ease-out ${r?"h-0":"h-auto"}`,children:n})]}),A=(r,a)=>{if(!a)return y(r);if(a&&["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","TRACE","CONNECT"].includes(a.toUpperCase())){if(a.toUpperCase()==="GET")return"bg-blue-50 text-blue-600";if(a.toUpperCase()==="POST")return"bg-green-50 text-green-600";if(a.toUpperCase()==="PUT")return"bg-yellow-50 text-yellow-600";if(a.toUpperCase()==="DELETE")return"bg-red-50 text-red-600";if(a.toUpperCase()==="PATCH")return"bg-purple-50 text-purple-600";if(a.toUpperCase()==="HEAD")return"bg-gray-50 text-gray-600";if(a.toUpperCase()==="OPTIONS")return"bg-orange-50 text-orange-600"}return y(r)},N=({messages:r,decodedCurrentPath:a})=>e.jsx("ul",{className:"space-y-0.5 border-l border-gray-200/80 ml-[9px] pl-4",children:r.map(t=>e.jsx("li",{"data-active":a===t.href,children:e.jsxs("a",{href:t.href,className:`flex items-center justify-between px-2 py-1.5 text-xs text-gray-600 hover:bg-purple-100 rounded-md ${a.includes(t.href)?"bg-purple-100 ":"hover:bg-purple-100"}`,children:[e.jsx("span",{className:"truncate",children:t.data?.sidebar?.label||t.data.name}),e.jsx("span",{className:`ml-2 text-[10px]  flex items-center gap-1 font-medium px-2 uppercase py-0.5 rounded ${A(t.collection,t.data?.sidebar?.badge)}`,children:t.data?.sidebar?.badge||S(t.collection)})]})},t.id))}),w="EventCatalog:catalogSidebarCollapsedGroups",L=300,y=r=>r==="commands"?"bg-blue-50 text-blue-600":r==="queries"?"bg-green-50 text-green-600":r==="events"?"bg-orange-50 text-orange-600":"text-gray-600",S=r=>r==="commands"?"Command":r==="queries"?"Query":r==="events"?"Event":r.slice(0,r.length-1).toUpperCase(),D=j.memo(({searchTerm:r})=>e.jsxs("div",{className:"px-4 py-6 text-center",children:[e.jsxs("div",{className:"text-gray-400 text-sm mb-2",children:['No results found for "',r,'"']}),e.jsxs("div",{className:"text-gray-400 text-xs",children:["Try:",e.jsxs("ul",{className:"mt-2 space-y-1 text-left list-disc pl-4",children:[e.jsx("li",{children:"Checking for typos"}),e.jsx("li",{children:"Using fewer keywords"}),e.jsx("li",{children:"Using more general terms"})]})]})]})),R=j.memo(({item:r,decodedCurrentPath:a,collapsedGroups:t,toggleGroupCollapse:n})=>e.jsx(b,{isCollapsed:t[r.href],onToggle:()=>n(r.href),title:e.jsxs("button",{onClick:d=>{d.stopPropagation(),n(r.href)},className:"flex justify-between items-center pl-2 w-full text-xs",children:[e.jsx("span",{className:"truncate text-xs font-bold",children:r.label}),e.jsx("span",{className:"text-purple-600 ml-2 text-[10px] font-medium bg-purple-50 px-2 py-0.5 rounded",children:"SERVICE"})]}),children:e.jsxs("div",{className:"space-y-0.5 border-gray-200/80 border-l pl-3 ml-[9px] mt-1",children:[e.jsx("a",{href:`${r.href}`,className:`flex items-center px-2 py-1.5 text-xs text-gray-600 hover:bg-purple-100 rounded-md ${a===r.href?"bg-purple-100":"hover:bg-purple-100"}`,children:e.jsx("span",{className:"truncate",children:"Overview"})}),e.jsx("a",{href:C("/architecture/docs/messages",{serviceName:r.name,serviceId:r.id}),className:`flex items-center px-2 py-1.5 text-xs text-gray-600 hover:bg-purple-100 rounded-md ${window.location.href.includes(`serviceId=${r.id}`)?"bg-purple-100":"hover:bg-purple-100"}`,children:e.jsx("span",{className:"truncate flex items-center gap-1",children:"Architecture"})}),r.specifications&&r.specifications.asyncapiPath&&e.jsxs("a",{href:m(`/docs/services/${r.id}/${r.version}/asyncapi`),className:`flex items-center px-2 py-1.5 text-xs text-gray-600 hover:bg-purple-100 rounded-md flex justify-between ${window.location.href.includes(`docs/services/${r.id}/${r.version}/asyncapi`)?"bg-purple-100":"hover:bg-purple-100"}`,children:[e.jsx("span",{className:"truncate flex items-center gap-1",children:"AsyncAPI specification"}),e.jsx("span",{className:"text-purple-600 ml-2 text-[10px] uppercase font-medium bg-gray-50 px-4 py-0.5 rounded",children:e.jsx("img",{src:m("/icons/asyncapi.svg",!0),className:"w-4 h-4"})})]}),r.specifications&&r.specifications.openapiPath&&e.jsxs("a",{href:m(`/docs/services/${r.id}/${r.version}/spec`),className:`items-center px-2 py-1.5 text-xs text-gray-600 hover:bg-purple-100 rounded-md flex justify-between ${window.location.href.includes(`docs/services/${r.id}/${r.version}/spec`)?"bg-purple-100":"hover:bg-purple-100"}`,children:[e.jsx("span",{className:"truncate flex items-center gap-1",children:"OpenAPI specification"}),e.jsx("span",{className:"text-green-600 ml-2 text-[10px] uppercase font-medium bg-gray-50 px-4 py-0.5 rounded",children:e.jsx("img",{src:m("/icons/openapi.svg",!0),className:"w-4 h-4"})})]}),e.jsx(b,{isCollapsed:t[`${r.href}-receives`],onToggle:()=>n(`${r.href}-receives`),title:e.jsxs("button",{onClick:d=>{d.stopPropagation(),n(`${r.href}-receives`)},className:"truncate underline ml-2 text-xs mb-1 py-1",children:["Receives messages (",r.receives.length,")"]}),children:e.jsx(N,{messages:r.receives,decodedCurrentPath:a})}),e.jsx(b,{isCollapsed:t[`${r.href}-sends`],onToggle:()=>n(`${r.href}-sends`),title:e.jsxs("button",{onClick:d=>{d.stopPropagation(),n(`${r.href}-sends`)},className:"truncate underline ml-2 text-xs mb-1 py-1",children:["Sends messages (",r.sends.length,")"]}),children:e.jsx(N,{messages:r.sends,decodedCurrentPath:a})})]})})),M=({resources:r,currentPath:a})=>{const t=i.useRef(null),[n]=i.useState(r),[d,f]=i.useState(""),[p,E]=i.useState(""),[I,T]=i.useState(!1),[u,v]=i.useState(()=>{if(typeof window<"u"){const s=window.localStorage.getItem(w);return T(!0),s?JSON.parse(s):{}}return{}}),x=window.location.pathname;i.useEffect(()=>{const s=setTimeout(()=>{E(d.toLowerCase())},L);return()=>clearTimeout(s)},[d]);const o=i.useMemo(()=>{if(!p)return n;const s=l=>l.label.toLowerCase().includes(p),c=l=>l.filter(h=>h.data.name.toLowerCase().includes(p));return{domains:n.domains?.filter(s)||[],services:n.services?.map(l=>({...l,sends:c(l.sends),receives:c(l.receives),isVisible:s(l)||l.sends.some(h=>h.data.name.toLowerCase().includes(p))||l.receives.some(h=>h.data.name.toLowerCase().includes(p))})).filter(l=>l.isVisible)||[],flows:n.flows?.filter(s)||[],messagesNotInService:n.messagesNotInService?.filter(l=>l.label.toLowerCase().includes(p))||[]}},[n,p]);i.useEffect(()=>{if(p){const s={...u};Object.keys(s).forEach(c=>{s[c]=!1}),v(s)}},[p]),i.useEffect(()=>{typeof window<"u"&&window.localStorage.setItem(w,JSON.stringify(u))},[u]),i.useEffect(()=>{const s=document.querySelector('[data-active="true"]');s&&s.scrollIntoView({behavior:"smooth",block:"center"})},[]);const g=i.useCallback(s=>{v(c=>({...c,[s]:!c[s]}))},[]),O=i.useCallback(s=>{f(s.target.value)},[]),P=i.useMemo(()=>s=>(n.domains||[]).some(l=>(l.domains||[]).some(k=>k.data.id===s.id)),[n.domains]);if(!I)return null;const U=p&&!o.domains?.length&&!o.services?.length&&!o.flows?.length&&!o.messagesNotInService?.length;return e.jsxs("nav",{ref:t,className:"space-y-4 text-gray-800 px-3 py-4",children:[e.jsx("input",{type:"text",value:d,onChange:O,placeholder:"Quick search...",className:"w-full p-2 text-sm rounded-md border border-gray-200 h-[30px]"}),e.jsx("div",{className:"space-y-2 divide-y divide-gray-200/80",children:U?e.jsx(D,{searchTerm:p}):e.jsxs(e.Fragment,{children:[o.domains&&e.jsx("div",{children:e.jsx("ul",{className:"space-y-2",children:o.domains.map(s=>e.jsxs("li",{className:"space-y-0","data-active":x===s.href,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:c=>{c.stopPropagation(),g(s.href)},className:"p-1 hover:bg-gray-100 rounded-md",children:e.jsx("div",{className:`transition-transform duration-150 ${u[s.href]?"":"rotate-180"}`,children:e.jsx($,{className:"h-3 w-3 text-gray-500"})})}),e.jsxs("button",{onClick:c=>{c.stopPropagation(),g(s.href)},className:`flex-grow flex items-center justify-between px-2 py-0.5 text-xs font-bold rounded-md ${x===s.href}`,children:[e.jsx("span",{className:"truncate",children:s.label}),e.jsx("span",{className:"text-yellow-600 ml-2 text-[10px] font-medium bg-yellow-50 px-2 py-0.5 rounded",children:P(s)?"SUBDOMAIN":"DOMAIN"})]})]}),e.jsx("div",{className:`overflow-hidden transition-[height] duration-150 ease-out ${u[s.href]?"h-0":"h-auto"}`,children:e.jsxs("div",{className:"space-y-0.5 border-gray-200/80 border-l pl-4 ml-[9px] mt-1",children:[e.jsx("a",{href:`${s.href}`,className:`flex items-center px-2 py-1.5 text-xs text-gray-600 hover:bg-purple-100 rounded-md ${x===s.href?"bg-purple-100 ":"hover:bg-purple-100"}`,children:e.jsx("span",{className:"truncate",children:"Overview"})}),e.jsx("a",{href:C("/architecture/docs/services",{serviceIds:s.services.map(c=>c.data.id).join(","),domainId:s.id,domainName:s.name}),className:`flex items-center px-2 py-1.5 text-xs text-gray-600 hover:bg-purple-100 rounded-md ${window.location.href.includes(`domainId=${s.id}`)?"bg-purple-100 ":"hover:bg-purple-100"}`,children:e.jsx("span",{className:"truncate",children:"Architecture"})}),e.jsx("a",{href:m(`/docs/domains/${s.id}/language`),className:`flex items-center px-2 py-1.5 text-xs text-gray-600 hover:bg-purple-100 rounded-md ${x.includes(`/docs/domains/${s.id}/language`)?"bg-purple-100 ":"hover:bg-purple-100"}`,children:e.jsx("span",{className:"truncate",children:"Ubiquitous Language"})})]})})]},s.href))})}),o.services&&e.jsx("div",{className:"pt-4 pb-2",children:e.jsx("ul",{className:"space-y-4",children:o.services.map(s=>e.jsx(R,{item:s,decodedCurrentPath:x,collapsedGroups:u,toggleGroupCollapse:g},s.href))})}),o.messagesNotInService&&e.jsx("div",{className:"pt-4 pb-2",children:e.jsx("ul",{className:"space-y-4",children:o.messagesNotInService.map(s=>e.jsx("li",{className:"space-y-0","data-active":x===s.href,children:e.jsxs("a",{href:s.href,className:`flex items-center justify-between px-2 py-0.5 text-xs font-bold rounded-md ${x===s.href?"bg-purple-100 text-purple-900":"hover:bg-purple-100"}`,children:[e.jsx("span",{className:"truncate",children:s.label}),e.jsx("span",{className:`ml-2 text-[10px] font-medium px-2 uppercase py-0.5 rounded ${y(s.collection)}`,children:S(s.collection)})]})},s.href))})}),o.flows&&e.jsx("div",{className:"pt-4 pb-2",children:e.jsx("ul",{className:"space-y-4",children:o.flows.map(s=>e.jsx("li",{className:"space-y-0","data-active":x===s.href,children:e.jsxs("a",{href:s.href,className:`flex items-center justify-between px-2 py-0.5 text-xs font-bold rounded-md ${x===s.href?"bg-cyan-100 text-cyan-900":"hover:bg-purple-100"}`,children:[e.jsx("span",{className:"truncate",children:s.label}),e.jsx("span",{className:"text-cyan-600 ml-2 text-[10px] font-medium bg-cyan-50 px-2 py-0.5 rounded",children:"FLOW"})]})},s.href))})})]})})]})},z=j.memo(M);export{z as default};
