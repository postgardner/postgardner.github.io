import{j as e}from"./jsx-runtime.DCqPeNwG.js";import{r as n}from"./index.66AI1_x2.js";import{a as o,b as $}from"./url-builder.CA2d8hgU.js";import{S as k,T as R,g as E,P as T}from"./components.ChMrURz-.js";import{F as C,a as m}from"./ServerIcon.DkuCCljB.js";import{a as f,F as L}from"./EnvelopeIcon.D1la4CBn.js";import"./_commonjsHelpers.Cpj98o6Y.js";function V({messages:p,embeded:u}){const[x,S]=n.useState(""),[s,P]=n.useState(null),[N,b]=n.useState(1),[l,_]=n.useState([]),[h,y]=n.useState("all"),v=15;n.useEffect(()=>{const a=new URLSearchParams(window.location.search),r=a.get("serviceId")||void 0,t=a.get("serviceName")?decodeURIComponent(a.get("serviceName")):void 0,d=a.get("domainId")||void 0,g=a.get("domainName")||void 0;P({serviceId:r,serviceName:t,domainId:d,domainName:g})},[]);const i=n.useMemo(()=>{if(s===null)return[];let a=[...p];if(l.length>0&&(a=a.filter(r=>l.includes(r.collection))),h==="no-producers"?a=a.filter(r=>!r.data.producers||r.data.producers.length===0):h==="no-consumers"&&(a=a.filter(r=>!r.data.consumers||r.data.consumers.length===0)),s.serviceId&&(a=a.filter(r=>r.data.producers?.some(t=>t.data.id===s.serviceId&&!t.id.includes("/versioned/"))||r.data.consumers?.some(t=>t.data.id===s.serviceId&&!t.id.includes("/versioned/")))),x){const r=x.toLowerCase();a=a.filter(t=>t.data.name?.toLowerCase().includes(r)||t.data.summary?.toLowerCase().includes(r)||t.data.producers?.some(d=>d.data.id?.toLowerCase().includes(r))||t.data.consumers?.some(d=>d.data.id?.toLowerCase().includes(r)))}return a.sort((r,t)=>r.data.name.localeCompare(t.data.name)),a},[p,x,s,l,h]),w=n.useMemo(()=>s?.serviceId||s?.domainId?1:Math.ceil(i.length/v),[i.length,s]),F=n.useMemo(()=>{if(s?.serviceId||s?.domainId)return i;const a=(N-1)*v;return i.slice(a,a+v)},[i,N,s]);n.useEffect(()=>{b(1)},[x,l]);const c=n.useMemo(()=>{if(!s?.serviceId)return{all:i};const a=s.serviceId,r=i.filter(d=>d.data.producers?.some(g=>g.data.id===a)),t=i.filter(d=>d.data.consumers?.some(g=>g.data.id===a));return{sends:r,receives:t}},[i,s]),M=()=>e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(R,{selectedTypes:l,onTypeChange:_,filteredCount:i.filter(a=>l.includes(a.collection)).length})}),e.jsx("div",{className:"flex items-center gap-2 border-l border-gray-200 pl-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:h,onChange:a=>y(a.target.value),className:"block rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-primary sm:text-sm sm:leading-6",children:[e.jsx("option",{value:"all",children:"All Messages"}),e.jsx("option",{value:"no-producers",children:"Without Producers"}),e.jsx("option",{value:"no-consumers",children:"Without Consumers"})]}),h!=="all"&&e.jsx("button",{onClick:()=>y("all"),className:"text-xs text-gray-500 hover:text-gray-700 hover:underline",children:"Clear"})]})})]}),j=a=>e.jsx("div",{className:`grid ${s?.serviceName?"grid-cols-1":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3"} gap-6`,children:a.map(r=>{const{color:t,Icon:d}=E(r.collection);return e.jsx("a",{href:o(`/docs/${r.collection}/${r.data.id}/${r.data.version}`),className:`group bg-white border hover:bg-${t}-100  rounded-lg shadow-sm  hover:shadow-lg transition-all duration-200 overflow-hidden border-${t}-500 `,children:e.jsxs("div",{className:"p-4 py-2 flex-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[!u&&e.jsx(d,{className:`h-5 w-5 text-${t}-500`}),e.jsxs("h3",{className:`font-semibold text-gray-900 truncate group-hover:text-${t}-500 transition-colors duration-200 ${u?"text-sm":"text-md"}`,children:[r.data.name," (v",r.data.version,")"]})]})}),r.data.summary&&e.jsx("p",{className:"text-gray-600 text-xs line-clamp-2 mb-4",children:r.data.summary}),!s?.serviceName&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-1",children:e.jsx(m,{className:"h-5 w-5 text-pink-500"})}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.data.producers?.length??0}),e.jsx("div",{className:"text-xs text-gray-500",children:"Producers"})]}),e.jsxs("div",{className:"text-center border-l border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-center mb-1",children:e.jsx(m,{className:"h-5 w-5 text-pink-500"})}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.data.consumers?.length??0}),e.jsx("div",{className:"text-xs text-gray-500",children:"Consumers"})]})]})})]})},r.data.name)})}),I=()=>w<=1||s?.serviceName||s?.domainId?null:e.jsx(T,{currentPage:N,totalPages:w,totalItems:i.length,itemsPerPage:v,onPageChange:b});return e.jsxs("div",{children:[e.jsxs("nav",{className:"mb-4 flex items-center space-x-2 text-sm text-gray-500",children:[e.jsxs("a",{href:o("/architecture/domains"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Domains"]}),e.jsx(f,{className:"h-4 w-4"}),e.jsxs("a",{href:o("/architecture/services"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(m,{className:"h-4 w-4"}),"Services"]}),e.jsx(f,{className:"h-4 w-4"}),e.jsxs("a",{href:o("/architecture/messages"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Messages"]}),s?.domainId&&e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("a",{href:$("/architecture/services",{domainName:s.domainName,domainId:s.domainId,serviceName:s.serviceName,serviceId:s.serviceId}),className:"hover:text-gray-700 hover:underline",children:s.domainId})]}),s?.serviceName&&e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{className:"text-gray-900",children:s.serviceName})]})]}),e.jsx("div",{className:"relative border-b border-gray-200 mb-4 pb-4",children:e.jsxs("div",{className:"md:flex md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1 max-w-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:s?.domainName?`Messages in ${s.serviceName}`:"All Messages"})}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:s?.domainName?`Browse messages in the ${s.serviceName} service`:"Browse and discover messages in your event-driven architecture"})]}),e.jsx("div",{className:"mt-6 md:mt-0 md:ml-4 flex-shrink-0",children:e.jsx(k,{searchQuery:x,onSearchChange:S,placeholder:"Search messages by name, summary, or services...",totalResults:i.length,totalItems:p.length})})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[M(),I()]})}),i.length>0&&e.jsxs("div",{className:`rounded-xl overflow-hidden ${s?.domainId?"bg-yellow-50 p-8 border-2 border-yellow-300":""}`,children:[s?.domainName&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-yellow-500"}),e.jsx("a",{href:$("/architecture/services",{domainName:s.domainName,domainId:s.domainId}),className:"text-2xl font-semibold text-gray-900 hover:underline",children:s.domainName})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:o(`/visualiser/domains/${s.domainId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium bg-white border border-gray-300 rounded-md transition-colors duration-200",children:"View in visualizer"}),e.jsx("a",{href:o(`/docs/domains/${s.domainId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-black border border-gray-300 bg-white  rounded-md transition-colors duration-200",children:"Read documentation"})]})]})}),e.jsx("div",{className:`rounded-xl overflow-hidden ${s?.serviceName?"bg-pink-50 p-8 border-2 border-dashed border-pink-300":""}`,children:s?.serviceName?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-8",children:[e.jsx(m,{className:"h-6 w-6 text-pink-500"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:s.serviceName}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsx("a",{href:o(`/visualiser/services/${s.serviceId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium bg-white border border-gray-300 rounded-md transition-colors duration-200 hover:bg-gray-50",children:"View in visualizer"}),e.jsx("a",{href:o(`/docs/services/${s.serviceId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-black border border-gray-300 bg-white rounded-md transition-colors duration-200 hover:bg-gray-50",children:"Read documentation"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-8 relative",children:[e.jsxs("div",{className:"bg-blue-50 bg-opacity-50 border border-blue-300 border-dashed rounded-lg p-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("h2",{className:`font-semibold text-gray-900 flex items-center gap-2 ${u?"text-sm":"text-xl"}`,children:[e.jsx(m,{className:"h-5 w-5 text-blue-500"}),"Receives messages (",c.receives?.length||0,")"]})}),c.receives&&c.receives.length>0?j(c.receives):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:l.length>0?`Service does not receive ${l.join(" or ")}`:"Service does not receive any messages"})})]}),e.jsxs("div",{className:"absolute left-[30%] top-1/2 -translate-y-1/2 flex items-center justify-center w-16",children:[e.jsx("div",{className:"w-full h-[3px] bg-blue-200 shadow-[0_0_0_1px_rgba(0,0,0,0.1)]"}),e.jsx("div",{className:"absolute right-0 w-4 h-4 border-t-[3px] border-r-[3px] border-blue-200 transform rotate-45 translate-x-1 translate-y-[-1px] shadow-[1px_-1px_0_1px_rgba(0,0,0,0.1)]"})]}),e.jsx("div",{className:"bg-white border-2 border-pink-100 rounded-lg p-3 flex items-center justify-center min-h-[80px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(m,{className:"h-10 w-10 text-pink-500"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:s.serviceName})]})}),e.jsxs("div",{className:"absolute right-[30%] top-1/2 -translate-y-1/2 flex items-center justify-center w-16",children:[e.jsx("div",{className:"w-full h-[3px] bg-green-200 shadow-[0_0_0_1px_rgba(0,0,0,0.1)]"}),e.jsx("div",{className:"absolute right-0 w-4 h-4 border-t-[3px] border-r-[3px] border-green-200 transform rotate-45 translate-x-1 translate-y-[-1px] shadow-[1px_-1px_0_1px_rgba(0,0,0,0.1)]"})]}),e.jsxs("div",{className:"bg-green-50  border border-green-300 border-dashed rounded-lg p-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("h2",{className:`font-semibold text-gray-900 flex items-center gap-2 ${u?"text-sm":"text-xl"}`,children:[e.jsx(m,{className:"h-5 w-5 text-emerald-500"}),"Sends messages (",c.sends?.length||0,")"]})}),c.sends&&c.sends.length>0?j(c.sends):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:l.length>0?`Service does not send ${l.join(" or ")}`:"Service does not send any messages"})})]})]})]}):e.jsxs(e.Fragment,{children:[j(F),e.jsx("div",{className:"mt-8 border-t border-gray-200",children:I()})]})})]}),i.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"No messages found matching your criteria"})})]})}export{V as default};
