import{d as _,F as A,J as D,c as k,R as $,K as j,b as f,o,k as w,x as E,f as i,e as C,N as z,L as I,M as P,q as c,O as R,z as q,u as t,P as B,t as L,w as v,$ as U,D as g,Q as M,S as O,T}from"./_OpenAPI.CJmNRckt.js";import{w as V}from"./DeleteSidebarListElement.vue.Cw9ULXXU.js";import{q as F}from"./Form.vue.BOGwbYRc.js";import"./jsx-runtime.DCqPeNwG.js";import"./index.66AI1_x2.js";import"./_commonjsHelpers.Cpj98o6Y.js";import"./preload-helper.BlTxHScW.js";import"./floating-ui.dom.DfmbYluP.js";/* empty css                       */import"./ViewLayoutSection.vue.zBItOo3b.js";const W={class:"bg-b-1 divide-0.5 flex w-full flex-col divide-y text-sm"},G=_({__name:"CollectionServerForm",props:{collectionId:{default:""},serverUid:{default:""}},setup(S){const r=S,{activeWorkspaceCollections:d}=A(),{servers:b,serverMutators:p}=D(),n=[{label:"URL",key:"url",placeholder:"https://void.scalar.com",type:"text"},{label:"Description",key:"description",placeholder:"Production",type:"text"}],a=k(()=>{const s=d.value.find(e=>e.uid===r.collectionId);return b[s&&typeof r.serverUid=="string"&&r.serverUid==="default"?s.servers[0]??"":s?.servers.find(e=>e===r.serverUid)??""]}),x=k(()=>{var s,e;return(s=a.value)!=null&&s.url?((e=a.value.url.match($.PATH))==null?void 0:e.map(l=>l.slice(1,-1)))??[]:[]});j(x,s=>{if(!a.value)return;const e=a.value.variables?{...a.value.variables}:{};Object.keys(e).forEach(l=>{s.includes(l)||delete e[l]}),s.forEach(l=>{e[l]||(e[l]={default:""})}),p.edit(a.value.uid,"variables",e)},{immediate:!0});const h=(s,e)=>{!d.value||!a.value||p.edit(a.value.uid,s,e)},y=(s,e)=>{if(!a.value)return;const l=a.value.variables||{};l[s]={...l[s],default:e},p.edit(a.value.uid,"variables",l)};return(s,e)=>(o(),f("div",W,[a.value?(o(),f(E,{key:0},[i(F,{data:a.value,onUpdate:h,options:n},null,8,["data"]),a.value.variables?(o(),C(z,{key:0,variables:a.value.variables,"onUpdate:variable":y},null,8,["variables"])):w("",!0)],64)):w("",!0)]))}}),H={class:"flex h-full w-full flex-col gap-12 px-1.5 pt-8"},Y={class:"flex flex-col gap-4"},J={class:"bg-b-2 overflow-hidden rounded-lg border"},K={class:"flex items-center justify-between py-1 pl-3 pr-1 text-sm"},Q={key:1},X={class:"text-c-3 flex h-full items-center justify-center rounded-lg border p-4"},ue=_({__name:"CollectionServers",setup(S){const{activeCollection:r}=A(),{servers:d,events:b,serverMutators:p}=D(),n=I(),a=P(null),x=k(()=>{var e;return!d||!((e=r.value)!=null&&e.servers)?[]:Object.values(d).filter(l=>{var m;return(m=r.value)==null?void 0:m.servers.includes(l.uid)})}),h=()=>b.commandPalette.emit({commandName:"Add Server"}),y=()=>{var e;!((e=r.value)!=null&&e.uid)||!a.value||(p.delete(a.value,r.value.uid),n.hide())},s=e=>{a.value=e,n.show()};return(e,l)=>{var m;return o(),f("div",H,[c("div",Y,[l[3]||(l[3]=R('<div class="flex items-start justify-between gap-2"><div class="flex flex-col"><div class="flex h-8 items-center"><h3 class="font-bold">Servers</h3></div><p class="text-sm"> Add different base URLs for your API. You can use <code class="font-code text-c-2">{variables}</code> for dynamic parts. </p></div></div>',1)),(o(!0),f(E,null,q(x.value,(u,N)=>(o(),f("div",{key:u.uid},[c("div",J,[c("div",K,[u.description?(o(),C(t(B),{key:0,value:u.description},null,8,["value"])):(o(),f("span",Q,"Server "+L(N+1),1)),i(t(O),{placement:"bottom-end"},{items:v(()=>[i(t(M),{class:"flex gap-2 font-normal",onClick:Z=>s(u.uid)},{default:v(()=>[i(t(g),{class:"inline-flex",icon:"Delete",size:"sm",thickness:"1.5"}),l[1]||(l[1]=c("span",null,"Delete",-1))]),_:2},1032,["onClick"])]),default:v(()=>[i(t(U),{class:"hover:bg-b-3 h-full max-h-8 gap-1 p-1 text-xs",variant:"ghost"},{default:v(()=>[i(t(g),{class:"text-c-3",icon:"Ellipses",size:"md"})]),_:1})]),_:2},1024)]),t(r)?(o(),C(G,{key:0,collectionId:t(r).uid,serverUid:u.uid},null,8,["collectionId","serverUid"])):w("",!0)])]))),128)),c("div",X,[i(t(U),{class:"hover:bg-b-2 hover:text-c-1 flex items-center gap-2",size:"sm",variant:"ghost",onClick:h},{default:v(()=>[i(t(g),{class:"inline-flex",icon:"Add",size:"sm",thickness:"1.5"}),l[2]||(l[2]=c("span",null,"Add Server",-1))]),_:1})])]),i(t(T),{size:"xxs",state:t(n),title:`Delete ${a.value?(m=t(d)[a.value])==null?void 0:m.url:"Server"}`},{default:v(()=>[i(V,{variableName:"Server",warningMessage:"Are you sure you want to delete this server? This action cannot be undone.",onClose:l[0]||(l[0]=u=>t(n).hide()),onDelete:y})]),_:1},8,["state","title"])])}}});export{ue as default};
